<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('partials/head') %>
    <link rel="stylesheet" href="/css/chatbots.css" />
  </head>

  <body>
    <div class="dashboard-container">
      <%- include('partials/sidebar') %>
      <main class="main-content">
        <%- include('partials/header') %>
        <div class="layout-container">
          <!-- AI Assistants Sidebar -->
          <div class="ai-sidebar">
            <div class="ai-sidebar-header">
              <h3 class="ai-sidebar-title">DKM ASSISTANTS</h3>
            </div>

            <div class="ai-assistants-list">
              <% assistants.forEach(function(assistant) { %>
              <div
                class="ai-assistant-item <%= activeAssistant === assistant.name ? 'active' : '' %>"
                data-assistant-id="<%= assistant.id %>"
              >
                <div class="ai-assistant-icon"><%- assistant.icon %></div>
                <div class="ai-assistant-name"><%= assistant.name %></div>
              </div>
              <% }); %>
            </div>
          </div>

          <!-- Main Content Area -->
          <div class="chat-main-content">
            <!-- Empty State (Initial View) -->
            <div class="empty-state" id="empty-state">
              <h1><span id="greeting-message"></span>, <%- user.username %>!</h1>
              <div class="empty-state-input-container">
                <input
                  type="text"
                  class="empty-state-input"
                  id="initial-input"
                  placeholder="How can i help you today?"
                />
                <div class="empty-state-input-buttons">
                  <button
                    class="empty-state-input-button"
                    id="attachment-button"
                  >
                    <svg
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.5"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <path
                        d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"
                      ></path>
                    </svg>
                  </button>
                  <button
                    class="empty-state-input-button"
                    id="send-initial-button"
                  >
                    <svg
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.5"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <line x1="22" y1="2" x2="11" y2="13"></line>
                      <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                  </button>
                </div>
              </div>
            </div>

            <!-- Chat Interface (Appears after first message) -->
            <div class="chat-container" id="chat-container">
              <div class="chat-messages" id="chat-messages">
                <!-- Messages will be dynamically added here -->
              </div>

              <div class="chat-input-container">
                <form id="chat-form" class="chat-form">
                  <textarea
                    id="user-input"
                    class="chat-input"
                    placeholder="Ask me anything..."
                    rows="1"
                  ></textarea>
                  <button
                    type="submit"
                    id="chat-submit"
                    class="chat-submit"
                    disabled
                  >
                    <svg
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <line x1="22" y1="2" x2="11" y2="13"></line>
                      <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Confirmation Popup -->
    <div id="confirmationPopup" class="popup-container">
      <div class="popup-content">
        <h3>Confirm Assistant Change</h3>
        <p>
          All your current chat messages will be lost. Are you sure you want to
          continue?
        </p>
        <div class="popup-buttons">
          <button id="confirmSwitch" class="button primary">Confirm</button>
          <button id="cancelSwitch" class="button secondary">Cancel</button>
        </div>
      </div>
    </div>

    <%- include('partials/footer') %>
    <script src="/js/chatbots.js"></script>
  </body>
</html>
